<head>
  <title>Astronomy</title>
</head>

<body></body>

<template name="Users">
  <div id="container">
    <h1>List of users</h1>
    <button type="button" name="add">Add new user</button>
    {{#each users}}
      {{> User}}
    {{/each}}
  </div>
</template>

<template name="User">
  <div class="user">
    <h2>
      <a href="{{pathFor 'edit' _id=this.get._id}}">{{fullName}}</a>
      <span class="remove">&#x00D7;</span>
    </h2>
    <div class="details">
      <div>E-mail: <a href="mailto:{{email}}">{{email}}</a></div>
      <div>Age: {{age}}</div>
      <div>Address: {{address.where}}</div>
      {{#if phones}}
        <div>Phones:</div>
        <ul>
          {{#each phones}}
            <li>{{name}} {{number}}</li>
          {{/each}}
        </ul>
      {{/if}}
      <div>Created: {{createdAt.toLocaleString}}</div>
      {{#if updatedAt}}
        <div>Update: {{updatedAt.toLocaleString}}</div>
      {{/if}}
    </div>
  </div>
</template>

<template name="UserForm">
  <div id="container">
    <form>
      {{#if isNew}}
        <h1>Editing "{{doc.fullName}}"</h1>
      {{else}}
        <h1>Adding a new user</h1>
      {{/if}}
      <div>
        <label for="firstName">First name</label>
        <input id="firstName" type="text" value="{{doc.firstName}}" class="{{#if doc.hasValidationError 'firstName'}}error{{/if}}" />
      </div>
      {{#if doc.hasValidationError 'firstName'}}
        <div class="error">{{doc.getValidationError 'firstName'}}</div>
      {{/if}}

      <div>
        <label for="lastName">Last name</label>
        <input id="lastName" type="text" value="{{doc.lastName}}" class="{{#if doc.hasValidationError 'lastName'}}error{{/if}}" />
      </div>
      {{#if doc.hasValidationError 'lastName'}}
        <div class="error">{{doc.getValidationError 'lastName'}}</div>
      {{/if}}

      <div>
        <label for="email">E-mail</label>
        <input id="email" type="text" value="{{doc.email}}" class="{{#if doc.hasValidationError 'email'}}error{{/if}}" />
      </div>
      {{#if doc.hasValidationError 'email'}}
        <div class="error">{{doc.getValidationError 'email'}}</div>
      {{/if}}

      <div>
        <label for="birthDate">Birth date</label>
        <input id="birthDate" type="date" value="{{doc.formattedBirthDate}}" class="{{#if doc.hasValidationError 'birthDate'}}error{{/if}}" />
      </div>
      {{#if doc.hasValidationError 'birthDate'}}
        <div class="error">{{doc.getValidationError 'birthDate'}}</div>
      {{/if}}

      <label>Address</label>
      {{#if doc.address}}
        <section>
          <div>
            <label for="address.city">City</label>
            <input id="address.city" type="text" value="{{doc.address.city}}" class="{{#if doc.address.hasValidationError 'city'}}error{{/if}}" />
          </div>
          {{#if doc.address.hasValidationError 'city'}}
            <div class="error">{{doc.address.getValidationError 'city'}}</div>
          {{/if}}

          <div>
            <label for="address.state">State</label>
            <input id="address.state" type="text" value="{{doc.address.state}}" class="{{#if doc.address.hasValidationError 'state'}}error{{/if}}" />
          </div>
          {{#if doc.address.hasValidationError 'state'}}
            <div class="error">{{doc.address.getValidationError 'state'}}</div>
          {{/if}}
        </section>
      {{/if}}

      <label>Phones</label>
      {{#if doc.phones}}
        {{#each doc.phones}}
        <section>
          <div>
            <label for="phones.{{@index}}.name">Name</label>
            <input id="phones.{{@index}}.name" type="text" value="{{name}}" class="{{#if hasValidationError 'name'}}error{{/if}}" />
          </div>
          {{#if hasValidationError 'name'}}
            <div class="error">{{getValidationError 'name'}}</div>
          {{/if}}

          <div>
            <label for="phones.{{@index}}.number">Number</label>
            <input id="phones.{{@index}}.number" type="text" value="{{number}}" class="{{#if hasValidationError 'number'}}error{{/if}}" />
          </div>
          {{#if hasValidationError 'number'}}
            <div class="error">{{getValidationError 'number'}}</div>
          {{/if}}
          <div>
            <button type="button" name="removePhone">Remove phone</button>
          </div>
        </section>
        {{/each}}
      {{/if}}


      <div>
        <button type="button" name="addPhone">Add phone</button>
      </div>
      <div>
        <button type="submit" name="save">Save</button>
      </div>
    </form>
  </div>
</template>
